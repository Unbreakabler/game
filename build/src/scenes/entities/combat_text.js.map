{"version":3,"file":"combat_text.js","sources":["../../../../../src/scenes/entities/combat_text.ts"],"sourcesContent":["const DEFAULT_STYLE = {\n  fontFamily: 'Georgia',\n  fontSize: '24px',\n  fontStyle: '',\n  backgroundColor: '',\n  color: '#fff',\n  stroke: '#000',\n  strokeThickness: 2,\n  align: 'center',\n  maxLines: 0,\n  fixedWidth: 0,\n  fixedHeight: 0,\n  rtl: false,\n}\n\n\n// TODO(jon): Add more styles for different types of hits\n// fire can be red, ice blue, etc\n// crits should be larger and \"shake\" or something for impact\n\nexport class CombatText extends Phaser.GameObjects.Text {\n  private starting_lifespan: number;\n  private remaining_lifespan: number;\n  private float_increase: number = 0;\n\n  constructor(scene: Phaser.Scene, \n              x: number, \n              y: number, \n              text: string, \n              style: Phaser.GameObjects.TextStyle = DEFAULT_STYLE as Phaser.GameObjects.TextStyle, \n              lifespan: number = 500\n  ) {\n    super(scene, x, y, text, style);\n    scene.add.existing(this);\n    this.starting_lifespan = lifespan;\n    this.remaining_lifespan = lifespan;\n  }\n\n  // Either remove the text or float it up and fade it.\n  public preUpdate(time: number, delta: number) {\n    this.remaining_lifespan -= delta;\n\n    if (this.remaining_lifespan < 0) {\n      this.setActive(false);\n      this.setVisible(false);\n      this.destroy();\n      return;\n    }\n    this.float();\n    this.fade();\n  }\n\n  private float() {\n    // Slowly float combat text up over lifespan\n    if (this.remaining_lifespan < (this.starting_lifespan * (4 / 5))) {\n      this.y -= this.float_increase\n      this.float_increase += 0.01\n    }\n  }\n  \n  // Slowly fade the alpha of the text to 0 over the lifespan of the combat text\n  private fade() {\n    const lifetime_used = this.remaining_lifespan / this.starting_lifespan + 0.5\n    this.setAlpha(lifetime_used)\n  }\n\n  \n}"],"names":[],"mappings":"AAAA,MAAM,aAAa,GAAG;IACpB,UAAU,EAAE,SAAS;IACrB,QAAQ,EAAE,MAAM;IAChB,SAAS,EAAE,EAAE;IACb,eAAe,EAAE,EAAE;IACnB,KAAK,EAAE,MAAM;IACb,MAAM,EAAE,MAAM;IACd,eAAe,EAAE,CAAC;IAClB,KAAK,EAAE,QAAQ;IACf,QAAQ,EAAE,CAAC;IACX,UAAU,EAAE,CAAC;IACb,WAAW,EAAE,CAAC;IACd,GAAG,EAAE,KAAK;CACX,CAAA;AAGD;AACA;AACA;MAEa,UAAW,SAAQ,MAAM,CAAC,WAAW,CAAC,IAAI;IAKrD,YAAY,KAAmB,EACnB,CAAS,EACT,CAAS,EACT,IAAY,EACZ,QAAsC,aAA6C,EACnF,WAAmB,GAAG;QAEhC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;QAT1B,mBAAc,GAAW,CAAC,CAAC;QAUjC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACzB,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;QAClC,IAAI,CAAC,kBAAkB,GAAG,QAAQ,CAAC;KACpC;;IAGM,SAAS,CAAC,IAAY,EAAE,KAAa;QAC1C,IAAI,CAAC,kBAAkB,IAAI,KAAK,CAAC;QAEjC,IAAI,IAAI,CAAC,kBAAkB,GAAG,CAAC,EAAE;YAC/B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YACtB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YACvB,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,OAAO;SACR;QACD,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;IAEO,KAAK;;QAEX,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,iBAAiB,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;YAChE,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,cAAc,CAAA;YAC7B,IAAI,CAAC,cAAc,IAAI,IAAI,CAAA;SAC5B;KACF;;IAGO,IAAI;QACV,MAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,iBAAiB,GAAG,GAAG,CAAA;QAC5E,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAA;KAC7B;;;;;"}