{"version":3,"file":"outline-frag.js","sources":["../../../../../src/plugins/shaders/outline-frag.ts"],"sourcesContent":["const frag = `\\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec2 texSize;\nuniform float thickness;\nuniform vec3 outlineColor; // (0, 0, 0);\nconst float DOUBLE_PI = 3.14159265358979323846264 * 2.;\n\nvec4 GetOutlineColor(vec4 front, float width, vec3 color) {\n  if (width > 0.0) {\n    vec2 mag = vec2(width/texSize.x, width/texSize.y);\n    vec4 curColor;\n    float maxAlpha = front.a;\n    vec2 offset;\n    for (float angle = 0.; angle < DOUBLE_PI; angle += #{angleStep}) {\n        offset = vec2(mag.x * cos(angle), mag.y * sin(angle));        \n        curColor = texture2D(uMainSampler, outTexCoord + offset);\n        maxAlpha = max(maxAlpha, curColor.a);\n    }\n    vec3 resultColor = front.rgb + (color.rgb * (1. - front.a)) * maxAlpha;\n    return vec4(resultColor, maxAlpha);\n  } else {\n    return front;\n  }\n}\nvoid main() {\n  vec4 front = texture2D(uMainSampler, outTexCoord);\n  gl_FragColor = GetOutlineColor(front, thickness, outlineColor);\n}\n`;\n\nconst MAX_SAMPLES = 100;\nconst MIN_SAMPLES = 1;\nvar GetFrag = function (quality: number) {\n  if (quality === undefined) {\n    quality = 0.1;\n  }\n  var samples = Math.max((quality * MAX_SAMPLES), MIN_SAMPLES);\n  var angleStep = (Math.PI * 2 / samples).toFixed(7);\n  return frag.replace(/\\#\\{angleStep\\}/, angleStep);\n}\n\nexport default GetFrag;"],"names":[],"mappings":"AAAA,MAAM,IAAI,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAuCZ,CAAC;AAEF,MAAM,WAAW,GAAG,GAAG,CAAC;AACxB,MAAM,WAAW,GAAG,CAAC,CAAC;IAClB,OAAO,GAAG,UAAU,OAAe;IACrC,IAAI,OAAO,KAAK,SAAS,EAAE;QACzB,OAAO,GAAG,GAAG,CAAC;KACf;IACD,IAAI,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,OAAO,GAAG,WAAW,GAAG,WAAW,CAAC,CAAC;IAC7D,IAAI,SAAS,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,GAAG,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;IACnD,OAAO,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,SAAS,CAAC,CAAC;AACpD;;;;"}