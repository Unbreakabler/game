{"version":3,"file":"enemy.js","sources":["../../../../../../src/scenes/entities/enemies/enemy.ts"],"sourcesContent":["import type TD from \"../../td\";\n\nconst DEFAULT_ENEMY_SPEED = 1 / 10;\nconst DEFAULT_ENEMY_HP = 100;\n\nexport default class Enemy extends Phaser.GameObjects.Sprite {\n  public follower: { t: number; vec: Phaser.Math.Vector2 };\n  private path: Phaser.Curves.Path | null = null;\n  private speed: number = DEFAULT_ENEMY_SPEED;\n  private health_points = DEFAULT_ENEMY_HP;\n  private original_health_points;\n  public constructor(\n    td_scene: TD,\n    x: number = 0,\n    y: number = 0,\n    sprite_name: string,\n    speed: number = DEFAULT_ENEMY_SPEED,\n    health_points: number = DEFAULT_ENEMY_HP,\n  ) {\n    super(td_scene as Phaser.Scene, x, y, sprite_name);\n    td_scene.add.existing(this);\n    td_scene.physics.add.existing(this);\n    td_scene.add.group(this, { active: true });\n    this.follower = { t: 0, vec: new Phaser.Math.Vector2() };\n    this.speed = speed;\n    this.health_points = health_points;\n    this.original_health_points = this.health_points; // health_points will need to be set for each enemy\n    this.setActive(true);\n    this.setVisible(true);\n  }\n\n  private resetEnemy(): void {\n    if (!this.path) {\n      return;\n    }\n    // set the t parameter at the start of the path\n    this.follower.t = 0;\n\n    // get x and y of the given t point\n    this.path.getPoint(this.follower.t, this.follower.vec);\n\n    // set the x and y of our enemy to the received from the previous step\n    this.setPosition(this.follower.vec.x, this.follower.vec.y);\n    this.health_points = this.original_health_points;\n  }\n\n  public setSpeed(speed: number): void {\n    this.speed = speed;\n  }\n\n  public startOnPath(path: Phaser.Curves.Path): void {\n    this.path = path;\n    this.resetEnemy();\n  }\n\n  public update(time: number, delta: number): void {\n    // move the t point along the path, 0 is the start and 0 is the end\n    if (!this.path) {\n      return; // skip updates if path has not be set by startOnPath\n    }\n    this.follower.t += (this.speed / this.path.getLength()) * delta;\n\n    // get the new x and y coordinates in vec\n    this.path.getPoint(this.follower.t, this.follower.vec);\n\n    // update enemy x and y to the newly obtained x and y\n    this.setPosition(this.follower.vec.x, this.follower.vec.y);\n\n    // if we have reached the end of the path, remove the enemy\n    if (this.follower.t >= 1) {\n      this.setActive(false);\n      this.setVisible(false);\n      this.destroy();\n      console.log(\"Enemy reached end.\");\n    }\n  }\n\n  public receiveDamage(damage: number): void {\n    this.health_points -= damage;\n    if (this.health_points < 0) {\n      this.setActive(false);\n      this.setVisible(false);\n      this.destroy();\n    }\n  }\n}\n"],"names":[],"mappings":"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"}